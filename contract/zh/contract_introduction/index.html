<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Conflux Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Conflux Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Conflux" href="/opensearch.xml"><title data-react-helmet="true">æ™ºèƒ½åˆçº¦ä»‹ç» | Conflux</title><meta data-react-helmet="true" property="og:url" content="https://developer.conflux-chain.org/contract/zh/contract_introduction"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="æ™ºèƒ½åˆçº¦ä»‹ç» | Conflux"><meta data-react-helmet="true" name="description" content="ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆçº¦"><meta data-react-helmet="true" property="og:description" content="ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆçº¦"><meta data-react-helmet="true" name="keywords" content="contract introduction"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://developer.conflux-chain.org/contract/zh/contract_introduction"><link data-react-helmet="true" rel="alternate" href="https://developer.conflux-chain.org/contract/zh/contract_introduction" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://developer.conflux-chain.org/contract/zh/contract_introduction" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://S86OJPVVGF-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.260e99e2.css">
<link rel="preload" href="/assets/js/styles.51c567ea.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.6c899fcf.js" as="script">
<link rel="preload" href="/assets/js/main.9ba92e73.js" as="script">
<link rel="preload" href="/assets/js/1.7bbaaa28.js" as="script">
<link rel="preload" href="/assets/js/2.6e1a68c1.js" as="script">
<link rel="preload" href="/assets/js/3.b44bd50a.js" as="script">
<link rel="preload" href="/assets/js/1be78505.82b13064.js" as="script">
<link rel="preload" href="/assets/js/113.892d81ca.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.7e5d0aa8.js" as="script">
<link rel="preload" href="/assets/js/17896441.66c9f095.js" as="script">
<link rel="preload" href="/assets/js/084a1826.b6f78d0c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Conflux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Conflux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Conflux Developer</strong></a><a class="navbar__item navbar__link" href="/guides/en/how_to_use_cfx_faucet">Guides</a><a class="navbar__item navbar__link" href="/">Core</a><a class="navbar__item navbar__link" href="/conflux-doc/docs/EVM-Space/intro_of_evm_space">eSpace</a><a class="navbar__item navbar__link" href="/conflux-doc/docs/json_rpc">APIs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/conflux-chain/conflux-rust" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Conflux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Conflux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Conflux Developer</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/guides/en/how_to_use_cfx_faucet">Guides</a></li><li class="menu__list-item"><a class="menu__link" href="/">Core</a></li><li class="menu__list-item"><a class="menu__link" href="/conflux-doc/docs/EVM-Space/intro_of_evm_space">eSpace</a></li><li class="menu__list-item"><a class="menu__link" href="/conflux-doc/docs/json_rpc">APIs</a></li><li class="menu__list-item"><a href="https://github.com/conflux-chain/conflux-rust" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">æ™ºèƒ½åˆçº¦ä»‹ç»</h1></header><div class="markdown"><p>ä»€ä¹ˆæ˜¯æ™ºèƒ½åˆçº¦
æ™ºèƒ½åˆçº¦æ¦‚å¿µäº1995å¹´ç”±Nick Szaboé¦–æ¬¡æå‡ºã€‚æ™ºèƒ½åˆçº¦ï¼ˆSmart contract ï¼‰æ˜¯ä¸€ç§æ—¨åœ¨ä»¥ä¿¡æ¯åŒ–æ–¹å¼ä¼ æ’­ã€éªŒè¯æˆ–æ‰§è¡ŒåˆåŒçš„è®¡ç®—æœºåè®®ã€‚æ™ºèƒ½åˆçº¦å…è®¸åœ¨æ²¡æœ‰ç¬¬ä¸‰æ–¹çš„æƒ…å†µä¸‹è¿›è¡Œå¯ä¿¡äº¤æ˜“ï¼Œè¿™äº›äº¤æ˜“å¯è¿½è¸ªä¸”ä¸å¯é€†è½¬ã€‚
å…¶çš„ç›®çš„æ˜¯æä¾›ä¼˜äºä¼ ç»Ÿåˆçº¦çš„å®‰å…¨æ–¹æ³•ï¼Œå¹¶å‡å°‘ä¸åˆçº¦ç›¸å…³çš„å…¶ä»–äº¤æ˜“æˆæœ¬ã€‚</p><p>åœ¨Confluxé“¾ä¸Šï¼Œâ€œæ™ºèƒ½åˆçº¦â€æ˜¯ä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œè¿è¡Œåœ¨Confluxé“¾ä¸Šï¼Œæ¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦å®ä¾‹å°±æ˜¯ä¸€ä¸ªä»£ç å’Œæ•°æ®çš„é›†åˆï¼Œé©»ç•™åœ¨confluxé“¾ä¸Šä¸€ä¸ªç‰¹å®šçš„åœ°å€ä¸Šã€‚ç”±äºåŒºå—é“¾ä¸Šçš„çŠ¶æ€éƒ½æ˜¯ç¡®å®šçš„ï¼Œå¯ä»¥ä¿è¯ä¸ºæ¯ä¸ªè¿è¡Œå®ƒä»¬çš„äººäº§ç”Ÿç›¸åŒçš„ç»“æœã€‚è€Œç”±äºæ™ºèƒ½åˆçº¦è¿è¡Œåœ¨åŒºå—é“¾ä¸Šï¼ŒåŒºå—é“¾çš„å»ä¸­å¿ƒåŒ–åŠä¸å¯ç¯¡æ”¹ç‰¹æ€§ä¿è¯äº†åˆçº¦è¿è¡Œçš„ç¡®å®šæ€§åŠå®‰å…¨æ€§ã€‚æ‰€ä»¥å¯ä»¥åŸºäºæ™ºèƒ½åˆçº¦åˆ›å»ºå¹¿æ³›çš„å»ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åº(DApps) ï¼Œå…¶ä¸­åŒ…æ‹¬æ¸¸æˆã€æ•°å­—æ”¶è—å“ã€åœ¨çº¿æŠ•ç¥¨ç³»ç»Ÿã€é‡‘èäº§å“ç­‰ã€‚</p><p>Confluxé“¾ä¸Šæœ‰ä¸¤ç§è´¦æˆ·ç±»å‹ï¼Œæ™®é€šè´¦æˆ·å’Œæ™ºèƒ½åˆçº¦è´¦æˆ·ï¼›æ™ºèƒ½åˆçº¦éƒ¨ç½²å®Œæˆåä¼šä¸ºè¯¥å®ä¾‹åˆ›å»ºä¸€ä¸ªæ™ºèƒ½åˆçº¦è´¦æˆ·ã€‚æ™ºèƒ½åˆçº¦è´¦æˆ·ä¹Ÿæœ‰CFXä½™é¢ï¼Œä¹Ÿå¯ä»¥ä¸å…¶å®ƒåˆçº¦äº¤äº’ã€‚ä½†å®ƒä»¬ä¸æ˜¯ç”±ç”¨æˆ·æ§åˆ¶çš„ï¼Œè€Œæ˜¯éƒ¨ç½²åˆ°ç½‘ç»œå¹¶æŒ‰ç…§ç¨‹åºè¿è¡Œçš„ã€‚ç„¶åï¼Œç”¨æˆ·å¸æˆ·å¯ä»¥é€šè¿‡æäº¤æ‰§è¡Œæ™ºèƒ½åˆçº¦ä¸Šå®šä¹‰çš„å‡½æ•°çš„äº¤æ˜“ä¸æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚æ™ºèƒ½åˆçº¦å¯ä»¥åƒä¼ ç»Ÿçš„åˆåŒä¸€æ ·å®šä¹‰è§„åˆ™ï¼Œå¹¶é€šè¿‡ä»£ç è‡ªåŠ¨æ‰§è¡Œå®ƒä»¬ã€‚</p><p>Nick Szabo ä½¿ç”¨äº†è‡ªåŠ¨å”®è´§æœºçš„åŸºæœ¬ä¾‹å­æ¥æè¿°å¦‚ä½•å°†ç°å®ä¸–ç•Œçš„åˆåŒä¹‰åŠ¡ç¼–ç¨‹åˆ°è½¯ä»¶å’Œç¡¬ä»¶ç³»ç»Ÿä¸­ã€‚æ¯ä¸ªäººåªè¦æŠŠæ­£ç¡®æ•°é‡çš„ç¡¬å¸æ”¾å…¥æœºå™¨ï¼Œå°±å¯ä»¥æœŸæœ›å¾—åˆ°ä¸€ä¸ªäº§å“ä½œä¸ºäº¤æ¢ã€‚åŒæ ·ï¼Œåœ¨ Conflux ä¸Šï¼Œæ™ºèƒ½åˆçº¦ä¹Ÿæ˜¯åœ¨æ»¡è¶³æŸç§ç‰¹å®šçš„æ¡ä»¶å°±èƒ½æ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡å¾—åˆ°ç‰¹å®šçš„ç»“æœã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¤ºä¾‹"></a>ç¤ºä¾‹<a class="hash-link" href="#ç¤ºä¾‹" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬çœ‹ä¸€ä¸ªæœ€ç®€å•è‡ªåŠ¨å”®è´§æœºæ™ºèƒ½åˆçº¦å®ç°</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pragma solidity </span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token number" style="color:rgb(247, 140, 108)">0.8</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">contract </span><span class="token maybe-class-name">VendingMachine</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Declare state variables of the contract</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">mapping</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Declare event for record purchase event</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    event </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Purchase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">address customer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> uint amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// When &#x27;VendingMachine&#x27; contract is deployed:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 1. set the deploying address as the owner of the contract</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 2. set the deployed smart contract&#x27;s cupcake balance to 100</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        owner </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Get user&#x27;s cupcake balance</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">address user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> view </span><span class="token function" style="color:rgb(130, 170, 255)">returns</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Allow the owner to increase the smart contract&#x27;s cupcake balance</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">refill</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Only the owner can refill.&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Allow anyone to purchase cupcakes</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">purchase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">uint amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> payable </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> amount </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> ether</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You must pay at least 1 CFX per cupcake&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Not enough cupcakes in stock to complete this purchase&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token function" style="color:rgb(130, 170, 255)">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-=</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        cupcakeBalances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        emit </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Purchase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¯¥åˆçº¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼Œ<code>refill</code>æ–¹æ³•å®ç°ç®¡ç†å‘˜è¡¥å……è´§ç‰©ï¼Œ<code>purchase</code>æ–¹æ³•å®ç°é¡¾å®¢æŠ•å¸ä¹°è´§ï¼›å°±åƒè‡ªåŠ¨å”®è´§æœºæ¶ˆé™¤äº†å¯¹å”®è´§å‘˜çš„éœ€æ±‚ä¸€æ ·ï¼Œæ™ºèƒ½åˆçº¦å¯ä»¥å–ä»£è®¸å¤šè¡Œä¸šçš„ä¸­ä»‹æœºæ„ã€‚</p><p>æ™ºèƒ½åˆçº¦å°±æ˜¯ä¸€ç»„ä»£ç ï¼ˆåˆçº¦å‡½æ•°) å’Œæ•°æ®ï¼ˆåˆçº¦çŠ¶æ€å˜é‡ï¼‰, å¦‚è¯­å¥<code>mapping (address =&gt; uint) public cupcakeBalances;</code>æ˜¯å£°æ˜ä¸€ä¸ªåç§°ä¸º<code>cupcakeBalances</code>, ç±»å‹ä¸º<code>mapping (address =&gt; uint)</code>çš„çŠ¶æ€å˜é‡ï¼Œä½ å¯ä»¥è®¤ä¸ºå®ƒæ˜¯æ•°æ®åº“é‡Œçš„ä¸€ä¸ªè¡¨ã€‚è€Œåˆçº¦å‡½æ•°<code>refill</code>å’Œ<code>purchase</code>çš„ä½œç”¨å°±æ˜¯è¯»å–æˆ–ä¿®æ”¹è¯¥æ•°æ®åº“è¡¨ä¸­æ•°æ®çš„çŠ¶æ€ã€‚</p><p>è¯¥åˆçº¦ç”±<code>solidity</code>è¯­è¨€å®ç°ï¼Œè¯­æ³•ä¸<code>javascript</code>ç›¸ä¼¼ã€‚</p><ul><li><code>pragma solidity ^0.8.0;</code>è¡¨æ˜è¯¥åˆçº¦éœ€è¦ç”¨<code>&gt;=0.8.0&lt;0.9.0</code>çš„ç¼–è¯‘å™¨ç¼–è¯‘ï¼›</li><li><code>contract VendingMachine</code>æŒ‡å®šåˆçº¦åç§°ä¸º<code>VendingMachine</code>ï¼›</li><li><code>address public owner;</code>å®šä¹‰äº†åç§°ä¸º<code>owner</code>ï¼Œç±»å‹ä¸º<code>address</code>çš„å…¬å¼€çŠ¶æ€å˜é‡ï¼›</li><li><code>event Purchase(address customer, uint amount);</code>å®šä¹‰äº†åç§°ä¸º<code>Purchase</code>çš„<code>event</code>ï¼Œ<code>event</code>ç±»ä¼¼äºå…¶ä»–è¯­è¨€çš„æ—¥å¿—åŠŸèƒ½ï¼Œå…¶ä½œç”¨ä¸»è¦æ˜¯è®°å½•åˆçº¦æ‰§è¡Œæ—¶çš„ä¸€äº›é‡è¦ä¿¡æ¯ã€‚å¦‚<code>Purchase</code>ç”¨äºåœ¨é¡¾å®¢è´­ä¹°å•†å“æ—¶äº§ç”Ÿè´­ä¹°è®°å½•çš„event</li><li><code>constrctor</code>å‡½æ•°ä¸ºæ„é€ å‡½æ•°ï¼Œåœ¨ä¸”åªåœ¨éƒ¨ç½²åˆçº¦æ—¶è¿è¡Œï¼›</li><li><code>balanceOf</code>å‡½æ•°ç”¨<code>view</code>ä¿®æ”¹ï¼Œè¡¨ç¤ºä¸ºåªè¯»å‡½æ•°ï¼Œä¸èƒ½ä¿®æ”¹åˆçº¦çŠ¶æ€ï¼›</li><li><code>refill</code>å‡½æ•°ä¸ºæ™®é€šå‡½æ•°ï¼Œé€šè¿‡å‘é€äº¤æ˜“çš„æ–¹å¼è°ƒç”¨ï¼Œä¼šæ”¹å˜åˆçº¦è£…çŠ¶æ€ï¼›<ul><li><code>require(msg.sender == owner,..);</code>è¡¨ç¤ºåªæœ‰æ»¡è¶³æ¡ä»¶<code>msg.sender == owner</code>æ—¶å³è°ƒç”¨è€…ä¸ºç®¡ç†å‘˜æ—¶æ‰èƒ½ä¿®æ”¹åˆçº¦å˜é‡<code>cupcakeBalances</code>çš„çŠ¶æ€ï¼Œå®Œæˆè¡¥è´§ï¼›</li></ul></li><li><code>purchase</code>å‡½æ•°æœ‰<code>payable</code>å…³é”®å­—ä¿®é¥°ï¼Œè¡¨ç¤ºåœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶å¯ä»¥åŒæ—¶å‘é€CFXï¼Œç”±äºé¡¾å®¢éœ€è¦æ”¯ä»˜CFXæ‰èƒ½è´­ä¹°è´§ç‰©ï¼Œæ‰€ä»¥ç”¨<code>payable</code>ä¿®é¥°<ul><li><code>require(msg.value &gt;= amount * 1 ether,..)</code>è¡¨ç¤ºå¿…é¡»æ”¯ä»˜è¶³é¢çš„CFXæ‰èƒ½è´­ä¹°</li><li>è´­ä¹°æˆåŠŸåå”®è´§æœºæ•°é‡å‡å°‘ï¼Œç”¨æˆ·æ‹¥æœ‰çš„è´§ç‰©æ•°é‡å¢åŠ ï¼Œ<code>cupcakeBalances[msg.sender]</code>è¡¨ç¤ºç”¨æˆ·æ‹¥æœ‰çš„è´§ç‰©æ•°é‡</li></ul></li></ul><p>åˆçº¦ä¹¦å†™å®Œæˆåéœ€è¦å…ˆç¼–è¯‘ã€ç„¶åé€šè¿‡å‘é€<a href="https://developer.confluxnetwork.org/introduction/en/conflux_basics#transactions" target="_blank" rel="noopener noreferrer">äº¤æ˜“</a>çš„æ–¹å¼éƒ¨ç½²åˆ°confluxé“¾ä¸Šã€‚ç„¶åå°±å¯ä»¥é€šè¿‡è°ƒç”¨åˆçº¦çš„æ–¹å¼å’Œåˆçº¦äº¤äº’äº†ã€‚</p><p>åˆçº¦ä¸€æ—¦éƒ¨ç½²ï¼Œä»»ä½•äººå¯ä»¥è°ƒç”¨ï¼Œä½†åªæœ‰æ»¡è¶³æ¡ä»¶æ‰èƒ½è§¦å‘åˆçº¦çŠ¶æ€æ”¹å˜ã€‚</p><p>æ›´è¯¦ç»†çš„solidityè¯­æ³•ä»‹ç»è¯·å‚è€ƒ<a href="https://docs.soliditylang.org/en/v0.8.4/" target="_blank" rel="noopener noreferrer">solidityå®˜æ–¹æ–‡æ¡£</a></p><p>ä¸‹é¢ä»‹ç»ç¼–è¯‘ã€éƒ¨ç½²ã€è°ƒç”¨åŠåˆçº¦æ‰§è¡Œçš„è¿‡ç¨‹</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¼–è¯‘"></a>ç¼–è¯‘<a class="hash-link" href="#ç¼–è¯‘" title="Direct link to heading">#</a></h3><p>åˆçº¦ç¼–è¯‘å°±æ˜¯é€šè¿‡ç¼–è¯‘å™¨å°†åˆçº¦ä»£ç ç”Ÿæˆéƒ¨ç½²åˆçº¦éœ€è¦çš„å…ƒç´ çš„è¿‡ç¨‹ã€‚ç¼–è¯‘ç»“æœä¸­ä¸»è¦æœ‰ä¸¤éƒ¨åˆ†<code>abi</code>å’Œ<code>bytecode</code>æ˜¯æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„ã€‚</p><ul><li><p>Bytecode: æ™ºèƒ½åˆçº¦æ˜¯åœ¨EVMä¸­æ‰§è¡Œçš„ï¼ŒBytecodeæ˜¯EVMå¯ä»¥è¯†åˆ«çš„åˆçº¦å¯¹åº”çš„16è¿›åˆ¶å€¼ã€‚</p></li><li><p>ABI: ABIå…¨ç§°Application Binary Interfaceï¼Œå³åº”ç”¨äºŒè¿›åˆ¶æ¥å£ã€‚ABIç”¨JSONæ ¼å¼æè¿°äº†åˆçº¦ä¸­å…¬å¼€å‡½æ•°çš„å‡½æ•°åã€ä¿®é¥°ç¬¦ã€å¯è§æ€§ã€å‚æ•°åç§°åŠå…¶ç±»å‹ã€è¿”å›å€¼åç§°åŠå…¶ç±»å‹ï¼Œä»¥åŠEventçš„æè¿°ã€‚ç›®çš„æ˜¯ä¸ºäº†æˆ‘ä»¬åœ¨å¤–éƒ¨è°ƒç”¨åˆçº¦å‡½æ•°æ—¶å¯ä»¥æ ¹æ®ABIä¸­è¯¥å‡½æ•°çš„æè¿°æŒ‰ç…§ç‰¹å®šçš„æ–¹æ³•è¿›è¡Œç¼–ç ä»è€Œå¾—åˆ°ä¸€ä¸ªEVMå¯ä»¥è¯†åˆ«çš„å€¼ï¼Œä»¥16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼›ä½¿ç”¨è¯¥å€¼å°±å¯ä»¥ä¸åˆçº¦äº¤äº’ã€‚</p></li></ul><p>ç¼–è¯‘æ™ºèƒ½åˆçº¦å¯ä»¥ä½¿ç”¨<code>solc</code>, <a href="https://github.com/Conflux-Chain/conflux-truffle" target="_blank" rel="noopener noreferrer">conflux-truffle</a>ç­‰è¿›è¡Œã€‚</p><p>è¿™é‡Œä»¥solcä¸ºä¾‹è¯´æ˜ã€‚</p><p>å®‰è£…solc</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">npm install -g solc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>æ³¨æ„ï¼šç¼–è¯‘å™¨ç‰ˆæœ¬éœ€è¦ä¸åˆçº¦æŒ‡å®šçš„ç‰ˆæœ¬åŒ¹é…ï¼Œå¦‚éœ€ä¸‹è½½æŒ‡å®šç‰ˆæœ¬v0.6.12ä½¿ç”¨<code>npm install -g solc@v0.6.12</code></p></blockquote><p>ç¼–è¯‘</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">solcjs ./VendingMachine.sol --bin --abi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å°†ç”Ÿæˆ <code>bytecode</code> æ–‡ä»¶ <code>__...VendingMachine.bin</code> å’Œ <code>abi</code> æ–‡ä»¶ <code>__...VendingMachine.abi</code></p><p><code>__...VendingMachine.bin</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">60806040523480156100...bfea2646970667358221220761301cb41bc1e4c37cc823f17fd695c6c09521a3e09fe1e8a7c51f6e77181a464736f6c63430008000033</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>__...VendingMachine.abi</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;inputs&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;stateMutability&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nonpayable&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;constructor&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;anonymous&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;inputs&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;indexed&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;internalType&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;address&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;customer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;address&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;indexed&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;internalType&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;uint256&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;amount&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;uint256&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Purchase&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;event&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ......</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²"></a>éƒ¨ç½²<a class="hash-link" href="#éƒ¨ç½²" title="Direct link to heading">#</a></h3><p>åˆçº¦éƒ¨ç½²å°±æ˜¯åœ¨confluxåŒºå—é“¾ä¸Šåˆ›å»ºä¸€ä¸ªåˆçº¦å®ä¾‹ï¼Œé€šè¿‡å‘é€ä¸€ç¬”<code>data</code>ä¸º<code>bytecode</code>ï¼Œ<code>to</code>ç•™ç©ºçš„<a href="https://developer.confluxnetwork.org/introduction/en/conflux_basics#transactions" target="_blank" rel="noopener noreferrer">äº¤æ˜“</a>å³å¯å®ç°åˆçº¦éƒ¨ç½²ã€‚</p><blockquote><p>å¦‚æœæ„é€ å‡½æ•°å¸¦å‚æ•°ï¼Œåˆ™<code>data</code>åº”ä¸º<code>bytecode</code>ä¸å¯¹<code>æ„é€ å‚æ•°</code>ABIç¼–ç åç»„åˆè€Œæˆçš„å€¼</p></blockquote><p>è¿™é‡Œç”¨<code>js-conflux-sdk</code>ä¸¾ä¾‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token maybe-class-name">Conflux</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;js-conflux-sdk&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> cfx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token maybe-class-name">Conflux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://test.confluxrpc.com&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> account </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> cfx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">wallet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addPrivateKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x2139FB4C55CB9AF7F0086CD800962C2E9013E2292BAE77978A9209E3BEE71D49&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// your bytecode</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> bytecode </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x608060405234801561001057600080fd5b50336000806101000a81548173ffffff......0008000033&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> deployReceipt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> cfx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sendTransaction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword module" style="font-style:italic">from</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> account</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> bytecode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">executed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// or use contract instance</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// let vendingMachine = cfx.Contract({ bytecode })</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// let deployReceipt = await vendingMachine.constructor().sendTransaction({from:account.address}).executed()</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;deploy tx receipt:&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> deployReceipt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œå‘é€ä¸€ç¬”dataä¸ºbytecodeçš„<a href="https://developer.confluxnetwork.org/introduction/en/conflux_basics#transactions" target="_blank" rel="noopener noreferrer">äº¤æ˜“</a>å³å®ç°äº†åˆçº¦éƒ¨ç½²ï¼Œéƒ¨ç½²å®Œæˆåï¼Œ<code>transaction receipt</code> çš„<code>contractCreated</code> å­—æ®µå°±æ˜¯éƒ¨ç½²å®Œæˆçš„åˆçº¦åœ°å€</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">deploy tx receipt</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  blockHash</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xe1b7f118447d3f945db4c2cf5752e592e542d4b9d24d0312b4ca5fce925c1ae5&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  contractCreated</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CFXTEST:TYPE.CONTRACT:ACCYSPEUUR469BCA0EXRFXKXMKX651W45JFW2RN5M0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  epochNumber</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">27675623</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword module" style="font-style:italic">from</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CFXTEST:TYPE.USER:AAP9KTHVCTUNVF030RBKK9K7ZBZYZ12DAJP1U3SP4G&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  gasCoveredBySponsor</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  gasFee</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">646047n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  gasUsed</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">646047n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  index</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  logs</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  logsBloom</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  outcomeStatus</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  stateRoot</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xd2ada6e3c04d6e8260446deaf1b8289d57ba84e2d82387155bbb397be93e2a30&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  storageCollateralized</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1664n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  storageCoveredBySponsor</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  storageReleased</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  to</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  transactionHash</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xe19d8a7527a7f655f0325374a5d483ed4459f465a2f7f9d3ac9a23a548eac5c4&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  txExecErrorMsg</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™é‡Œä¸ºäº†æ›´å¥½çš„è¯´æ˜åˆçº¦éƒ¨ç½²åŸç†ä½¿ç”¨ç›´æ¥å‘<a href="https://developer.confluxnetwork.org/introduction/en/conflux_basics#transactions" target="_blank" rel="noopener noreferrer">äº¤æ˜“</a>çš„æ–¹å¼ï¼Œå½“åˆçº¦æœ‰å¸¦å‚æ•°çš„æ„é€ å‡½æ•°å‚æ•°ï¼Œæ›´å‹å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨<a href="https://github.com/Conflux-Chain/js-conflux-sdk/blob/master/docs/interact_with_contract.md" target="_blank" rel="noopener noreferrer"><code>js-conflux-sdk</code> <code>contract</code></a>å¯¹è±¡è¿›è¡Œï¼Œæˆ–è€…ä½¿ç”¨ <a href="https://github.com/Conflux-Chain/conflux-truffle" target="_blank" rel="noopener noreferrer"><code>conflux-truffle</code></a> ç­‰åˆçº¦å¼€å‘å·¥å…·éƒ¨ç½²ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è°ƒç”¨"></a>è°ƒç”¨<a class="hash-link" href="#è°ƒç”¨" title="Direct link to heading">#</a></h3><p>åˆçº¦éƒ¨ç½²å®Œæˆåï¼Œå°±å¯ä»¥è·Ÿåˆçº¦äº¤äº’äº†ï¼Œäº¤äº’æ–¹å¼åˆ†ä¸¤ç§</p><ul><li><p>ä¸€ç§è°ƒç”¨æ–¹å¼æ˜¯é€šè¿‡ rpc <code>cfx_call</code>ï¼Œè¿™ç§åªæ˜¯åœ¨EVMä¸­æ‰§è¡Œè¯¥åˆçº¦è°ƒç”¨ä½†ä¸å®é™…æ”¹å˜çŠ¶æ€ï¼Œé€šå¸¸ç”¨äºè°ƒç”¨åªè¯»åˆçº¦å‡½æ•°æˆ–è€…æ¨¡æ‹Ÿæ‰§è¡Œåˆçº¦æŸ¥çœ‹æ˜¯å¦åˆçº¦èƒ½å¤Ÿæ‰§è¡ŒæˆåŠŸ</p></li><li><p>å¦ä¸€ç§åˆçº¦è°ƒç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€<a href="https://developer.confluxnetwork.org/introduction/en/conflux_basics#transactions" target="_blank" rel="noopener noreferrer">äº¤æ˜“</a>çš„æ–¹å¼å®Œæˆï¼Œè¿™æ—¶ä¼šæ‰§è¡Œåˆçº¦å¹¶æ”¹å˜åˆçº¦çŠ¶æ€ã€‚</p></li></ul><p>è°ƒç”¨åˆçº¦æ—¶ä½¿ç”¨çš„dataæ˜¯æ ¹æ®ABIæè¿°çš„å‡½æ•°ä¿¡æ¯ç»è¿‡<a href="https://docs.soliditylang.org/en/develop/abi-spec.html" target="_blank" rel="noopener noreferrer">ABIç¼–ç </a>çš„æ–¹å¼ç”Ÿæˆçš„ã€‚å…¶ä¸­å‰4ä¸ªå­—èŠ‚ä¸ºå‡½æ•°é€‰æ‹©å™¨(å‡½æ•°ç­¾åçš„ Keccakï¼ˆSHA-3ï¼‰å“ˆå¸Œçš„å‰4å­—èŠ‚)ï¼Œç¬¬äº”ä¸ªå­—èŠ‚å¼€å§‹ä¸ºè¢«ç¼–ç çš„å‚æ•°ã€‚</p><p>æˆ‘ä»¬ä»¥ js-conflux-sdk ä¸ºä¾‹è°ƒç”¨åˆçº¦</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token maybe-class-name">Conflux</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;js-conflux-sdk&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> cfx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token maybe-class-name">Conflux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://test.confluxrpc.com&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> logger</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> console </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> me </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> cfx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">wallet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addPrivateKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x2139FB4C55CB9AF7F0086CD800962C2E9013E2292BAE77978A9209E3BEE71D49&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> abi </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> contract </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> cfx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access maybe-class-name" style="color:rgb(130, 170, 255)">Contract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> address</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CFXTEST:TYPE.CONTRACT:ACCYSPEUUR469BCA0EXRFXKXMKX651W45JFW2RN5M0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> abi </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> myBalance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">me</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my cupcake balance :&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> myBalance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> receipt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">purchase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sendTransaction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> me</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2e18</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">executed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;purchase receipt&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> receipt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> event </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> contract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">abi</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">decodeLog</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">receipt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">logs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;purchase event:&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    myBalance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> contract</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">balanceOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">me</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;after purchase, my cupcake balance :&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> myBalance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä» log ä¸­å¯ä»¥çœ‹åˆ° <code>contract.cupcakeBalances(me.address)</code>å¯¹åº”çš„ rpc ä¿¡æ¯ä¸º</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    jsonrpc</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2.0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1794b9e755639b5164925a8e&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cfx_call&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        to</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CFXTEST:TYPE.CONTRACT:ACCYSPEUUR469BCA0EXRFXKXMKX651W45JFW2RN5M0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xe18a7b9200000000000000000000000019f4bcf113e0b896d9b34294fd3da86b4adf0302&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword nil" style="font-style:italic">undefined</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  result</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x0000000000000000000000000000000000000000000000000000000000000000&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  duration</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>rpc method ä¸º<code>cfx_call</code>ï¼Œ dataä¸º<code>å‡½æ•°é€‰æ‹©å™¨ + å¯¹å‚æ•°åˆ—è¡¨ABIç¼–ç </code>çš„ç»“æœï¼Œå‰4å­—èŠ‚<code>0xe18a7b92</code>ä¸ºå‡½æ•°<code>balanceOf</code>çš„å‡½æ•°é€‰æ‹©å™¨ï¼Œè®¡ç®—æ–¹æ³•ä¸ºå¯¹<code>balanceOf</code>çš„ç­¾å<code>balanceOf(address)</code>åškeccakè¿ç®—<code>keccak256(&quot;balanceOf(address)&quot;)</code>åå–å‰4å­—èŠ‚ã€‚åé¢çš„å­—èŠ‚<code>00000000000000000000000019f4bcf113e0b896d9b34294fd3da86b4adf0302</code>ä¸ºå‚æ•° <code>address</code> ç±»å‹, å€¼ <code>0x19f4bcf113e0b896d9b34294fd3da86b4adf0302</code> çš„ABIç¼–ç ç»“æœã€‚</p><p>è¿”å›å€¼<code>0x0000000000000000000000000000000000000000000000000000000000000000</code>æ˜¯ ç±»å‹  <code>uint</code>, å€¼ <code>0</code> çš„ç¼–ç ç»“æœã€‚</p><p>è€Œ<code>purchase</code>çš„ rpc method ä¸º<code>cfx_sendRawTransaction</code>ï¼Œå³å‘é€ä¸€ç¬”<a href="https://developer.confluxnetwork.org/introduction/en/conflux_basics#transactions" target="_blank" rel="noopener noreferrer">äº¤æ˜“</a>ï¼Œè¿™ä¼šæ”¹å˜åˆçº¦çŠ¶æ€ã€‚å¯ä»¥é€šè¿‡ <code>getTransactionByHash</code> çœ‹åˆ°è¯¥äº¤æ˜“çš„ <code>data</code> ä¹Ÿæ˜¯åŒæ ·çš„ <code>å‡½æ•°é€‰æ‹©å™¨ + å¯¹å‚æ•°åˆ—è¡¨ABIç¼–ç </code>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;jsonrpc&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;result&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;data&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0xefef39a10000000000000000000000000000000000000000000000000000000000000002&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;hash&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x2c188c67247d7e2bf12fb96f17ced61da8ea4143447887a10a2cc597c1fa66e1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;to&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CFXTEST:TYPE.CONTRACT:ACCYSPEUUR469BCA0EXRFXKXMKX651W45JFW2RN5M0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x1bc16d674ec80000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä»<code>transaction receipt</code>ä¸­å¯ä»¥çœ‹åˆ°<code>logs</code>å­—æ®µæœ‰ä¸€æ¡è®°å½•ï¼Œ<code>logs</code>è¡¨ç¤ºè¯¥ç¬”äº¤æ˜“å‘ç”Ÿçš„äº‹ä»¶</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">purchase receipt </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  blockHash</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x3d4111b299e65c279184aa83021e59f9d134baa9c78969dd6d94a92bfbd340df&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  contractCreated</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  epochNumber</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">27677382</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword module" style="font-style:italic">from</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CFXTEST:TYPE.USER:AAP9KTHVCTUNVF030RBKK9K7ZBZYZ12DAJP1U3SP4G&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  logs</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      address</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CFXTEST:TYPE.CONTRACT:ACCYSPEUUR469BCA0EXRFXKXMKX651W45JFW2RN5M0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x00000000000000000000000019f4bcf113e0b896d9b34294fd3da86b4adf03020000000000000000000000000000000000000000000000000000000000000002&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      topics</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>äº‹ä»¶è§£æç»“æœä¸º</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">purchase event</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Purchase&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  fullName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Purchase(address customer, uint256 amount)&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Purchase(address,uint256)&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  signature</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x2499a5330ab0979cc612135e7883ebc3cd5c9f7a8508f042540c34723348f632&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  array</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cfxtest:aap9kthvctunvf030rbkk9k7zbzyz12dajp1u3sp4g&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2n</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  object</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customer</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cfxtest:aap9kthvctunvf030rbkk9k7zbzyz12dajp1u3sp4g&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    amount</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2n</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¡¨ç¤ºå‘ç”Ÿäº†ä¸€ä¸ª<code>Purchase</code>äº‹ä»¶ï¼Œcustomerä¸º<code>cfxtest:aap9kthvctunvf030rbkk9k7zbzyz12dajp1u3sp4g</code>ï¼Œæ•°é‡ä¸º2</p><p><code>purchase</code>å®Œæˆåï¼Œ<code>cupcakeBalances[0x19f4bcf113e0b896d9b34294fd3da86b4adf0302]</code> ç”± 0 å˜ä¸º 2ã€‚çŠ¶æ€å‘ç”Ÿæ”¹å˜ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    jsonrpc</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2.0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;179a19eb98ed23dda1d1d516&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cfx_call&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword nil" style="font-style:italic">undefined</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  result</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x0000000000000000000000000000000000000000000000000000000000000002&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  duration</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒConfluxé“¾ä¸Šåœ¨éƒ¨ç½²åˆçº¦å’Œè°ƒç”¨åˆçº¦çš„æ—¶å€™ï¼Œå¦‚æœåœ¨åˆçº¦ä¸­æ–°å¢å­˜å‚¨ç©ºé—´å ç”¨æ—¶ï¼Œéœ€è¦ä¸ºå ç”¨çš„å­˜å‚¨ç©ºé—´æŠµæŠ¼ä¸€éƒ¨åˆ†cfxï¼›è¯¥éƒ¨åˆ†è´¹ç”¨ä¼šåœ¨å­˜å‚¨é‡Šæ”¾åè¿”è¿˜ï¼Œè¯¦æƒ…å‚è§<a href="https://juejin.cn/post/6855551378123653127" target="_blank" rel="noopener noreferrer">Confluxçš„å­˜å‚¨æŠµæŠ¼æœºåˆ¶</a></p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ·±å…¥å­¦ä¹ "></a>æ·±å…¥å­¦ä¹ <a class="hash-link" href="#æ·±å…¥å­¦ä¹ " title="Direct link to heading">#</a></h2><p>æ™ºèƒ½åˆçº¦å¼€å‘é™¤äº†solidityè¯­è¨€å¤–ï¼Œè¿˜æœ‰vyperç­‰</p><ul><li><a href="https://docs.soliditylang.org/en/v0.8.4/" target="_blank" rel="noopener noreferrer">Solidity</a></li><li><a href="https://vyper.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">Vyper</a></li></ul><p>Confluxæœ‰æ›´å‹å¥½çš„æ™ºèƒ½å¼€å‘å·¥å…·ä¾›å¼€å‘è€…ä½¿ç”¨ï¼Œæé«˜å¼€å‘æ•ˆç‡</p><ul><li><a href="https://github.com/Conflux-Chain/conflux-truffle" target="_blank" rel="noopener noreferrer">Conflux-Truffle</a></li></ul><p>å…¶å®ƒ</p><ul><li><a href="https://developer.conflux-chain.org/introduction/en/conflux_basics" target="_blank" rel="noopener noreferrer">ConfluxåŸºæœ¬æ¦‚å¿µä»‹ç»</a></li><li><a href="https://ethereum.org/zh/developers/docs/smart-contracts/" target="_blank" rel="noopener noreferrer">Ethereumå¯¹æ™ºèƒ½åˆçº¦çš„ä»‹ç»</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Conflux-Chain/conflux-developer-site/edit/master/docs/contract/zh/introduce.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç¤ºä¾‹" class="table-of-contents__link">ç¤ºä¾‹</a><ul><li><a href="#ç¼–è¯‘" class="table-of-contents__link">ç¼–è¯‘</a></li><li><a href="#éƒ¨ç½²" class="table-of-contents__link">éƒ¨ç½²</a></li><li><a href="#è°ƒç”¨" class="table-of-contents__link">è°ƒç”¨</a></li></ul></li><li><a href="#æ·±å…¥å­¦ä¹ " class="table-of-contents__link">æ·±å…¥å­¦ä¹ </a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Overview</a></li><li class="footer__item"><a href="https://fluentwallet.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Fluent Wallet</a></li><li class="footer__item"><a href="https://confluxscan.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conflux Scan</a></li><li class="footer__item"><a href="http://faucet.confluxnetwork.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testnet Faucet</a></li><li class="footer__item"><a href="https://evm.fluentwallet.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Space Bridge</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Tools</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.obsidians.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conflux studio</a></li><li class="footer__item"><a href="https://chainide.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ChainIDE</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://bountyv2.confluxnetwork.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bounty</a></li><li class="footer__item"><a href="https://forum.conflux.fun/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li><li class="footer__item"><a href="https://discord.com/invite/aCZkf2C" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Conflux-Chain" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/Conflux_Network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://medium.com/@ConfluxNetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2022 Conflux. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/styles.51c567ea.js"></script>
<script src="/assets/js/runtime~main.6c899fcf.js"></script>
<script src="/assets/js/main.9ba92e73.js"></script>
<script src="/assets/js/1.7bbaaa28.js"></script>
<script src="/assets/js/2.6e1a68c1.js"></script>
<script src="/assets/js/3.b44bd50a.js"></script>
<script src="/assets/js/1be78505.82b13064.js"></script>
<script src="/assets/js/113.892d81ca.js"></script>
<script src="/assets/js/935f2afb.7e5d0aa8.js"></script>
<script src="/assets/js/17896441.66c9f095.js"></script>
<script src="/assets/js/084a1826.b6f78d0c.js"></script>
</body>
</html>